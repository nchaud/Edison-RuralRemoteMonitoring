/* Shield UI 1.7.26 Free for Non-Commercial Version | Copyright 2013-2016 Shield UI Ltd. | http://www.shieldui.com/eula */
!function(a,b,P,h){var K,f,d,e,s,C,z,o,J,D,y=b.ui.Widget,Q=b.Class,r=(b.Constants.KeyCode,document),i=a.proxy,g=(a.each,a.extend),N=(a.map,a.contains),p=(a.trim,b.error,b.guid),O=b.format,x=b.is.defined,c=(b.is["boolean"],b.is.integer,b.is.func),L=(b.is.array,b.is.object,b.is.string),U=b.to.string,n=b.support.browser,B="disabled",R="focus",S="blur",F="click",M="keyup",G="keydown",H="formatting",k="text-formatting",w="font-and-colors",u="alignment",t="lists",E="links",m="sui-editor",q="styleWithCSS",l=function(){},j=function(c,a,b,d){if(d)try{c.execCommand(a,!1,b)}catch(e){l("execCommand({0}, {1}) error: {3}",a,b,e)}else c.execCommand(a,!1,b)},v="about",I="About",T=function(b){return a("<div/>").html(b).text()},A="&#x44;&#x65;&#x6D;&#x6F;&#x20;&#x76;&#x65;&#x72;&#x73;&#x69;&#x6F;&#x6E;&#x20;&#x62;&#x79;";A+="&#x20;&#x3C;&#x61;&#x20;&#x68;&#x72;&#x65;&#x66;&#x3D;&#x22;&#x68;&#x74;&#x74;&#x70;&#x3A;&#x2F;&#x2F;&#x77;&#x77;&#x77;&#x2E;&#x73;&#x68;",K=function(d,c){var f,e,g,b;!d.getSelection&&c.selection&&(f=null,d.getSelection=function(){return null!=f?f:f=new g},c.createRange=function(){return new e},c.attachEvent("onkeydown",function(){return d.getSelection().setRangeAt(0,new e(!0))}),c.attachEvent("onselectionchange",function(){var a,b,f;try{b=new e(!0)}catch(g){}if(b)return d.getSelection().setRangeAt(0,b),a=c.selection.createRange().parentElement(),"INPUT"===a.tagName||"TEXTAREA"===a.tagName?(f=d.getSelection().getRangeAt(0),a.selectionStart=f.selectionStart,a.selectionEnd=f.selectionEnd,a.selectionEnd):void 0}),e=d.Range=function(){var d=function(b){var a=this;b?a.range=c.selection.createRange():(a.range=c.body.createTextRange(),a.collapse(!0)),a.init()};return d.END_TO_END="EndToEnd",d.END_TO_START="EndToStart",d.START_TO_END="StartToEnd",d.START_TO_START="StartToStart",d.prototype.init=function(){var f,e,c,g,h,d,a=this;return e=a.range.parentElement(),a.commonAncestorContainer=e,a.collapsed=0===a.compareBoundaryPoints("StartToEnd",a),d=a.range.duplicate(),d.moveToElementText(e),f=a.range.text.length>0?0:1,h=b.findLength("StartToStart",d,a.range),c=b.findNodeByPos(e,h,f),a.startContainer=c.el,a.startOffset=c.offset,g=b.findLength("StartToEnd",d,a.range),c=b.findNodeByPos(e,g,1),a.endContainer=c.el,a.endOffset=c.offset,a.selectionStart=b.findLength("StartToStart",d,a.range,a),a.selectionEnd=b.findLength("StartToEnd",d,a.range,a),a.selectionEnd},d.prototype.select=function(){return this.range.select()},d.prototype.setStart=function(c,e){var f,a,d=this;return b.getText(c).length>=e&&e>=0?(a=d.range.duplicate(),3===c.nodeType&&(f=b.findPosFromNode(c),a.moveToElementText(c.parentNode),a.moveStart("character",f+e)),-1===d.range.compareEndPoints("StartToEnd",a)&&d.range.setEndPoint("EndToStart",a),d.range.setEndPoint("StartToStart",a)):void 0},d.prototype.setEnd=function(a,d){var e,c,f=this;return b.getText(a).length>=d&&d>=0?(c=f.range.duplicate(),3===a.nodeType&&(e=b.findPosFromNode(a),c.moveToElementText(a.parentNode),c.moveStart("character",e+d)),f.range.setEndPoint("EndToStart",c)):void 0},d.prototype.selectNodeContents=function(a){return this.range.moveToElementText(a)},d.prototype.collapse=function(b){var a=this;return b?a.range.setEndPoint("EndToStart",a.range):a.range.setEndPoint("StartToEnd",a.range)},d.prototype.deleteContents=function(){},d.prototype.insertNode=function(b){var d=b.outerHTML?b.outerHTML:a(c.createElement("div")).append(a(b).clone()).html();this.range.pasteHTML(d)},d.prototype.compareBoundaryPoints=function(a,b){return this.range.compareEndPoints(a,b.range)},d.prototype.cloneRange=function(){var a=new d;return a.range=this.range.duplicate(),a.init(),a},d.prototype.detach=function(){return delete this.range},d.prototype.getBoundingClientRect=function(){var a=this.range.getBoundingClientRect();return{width:a.right-a.left,height:a.bottom-a.top,left:a.left,right:a.right,bottom:a.bottom,top:a.top}},d.prototype.toString=function(){return this.range.text||""},d}(),g=function(){var a=function(){this.selection=c.selection,this.ranges=[],this.init()};return a.prototype.init=function(){var c,b,d,f,g,a=this;return a.rangeCount=a.ranges.length,a.rangeCount?(b=a.ranges[0],null==a.prev&&(a.prev=b),0===b.compareBoundaryPoints(e.END_TO_END,a.prev)?(f=["end","start"],c=f[0],d=f[1]):(g=["start","end"],c=g[0],d=g[1]),a.anchorNode=b[""+c+"Container"],a.anchorOffset=b[""+c+"Offset"],a.focusNode=b[""+d+"Container"],a.focusOffset=b[""+d+"Offset"],a.isCollapsed=a.anchorNode===a.focusNode,a.isCollapsed):void 0},a.prototype.getRangeAt=function(a){return this.ranges[a]},a.prototype.setRangeAt=function(b,c){var a=this;return a.prev=a.ranges[b],a.ranges[b]=c,a.init()},a.prototype.removeAllRanges=function(){return this.ranges=[],this.init()},a.prototype.addRange=function(g){var e,a,f,b,c,d=this;for(d.ranges.push(g),d.init(),b=d.ranges,c=[],a=0,f=b.length;f>a;a++)e=b[a],c.push(e.select());return c},a.prototype.deleteFromDocument=function(){return this.selection.clear()},a.prototype.toString=function(){return this.ranges[0].toString()},a}(),b={convertLineBreaks:function(a){return a.replace(/\r\n/g,"\n")},stripLineBreaks:function(a){return a.replace(/\r\n/g,"")},getText:function(a){return a.innerText||a.nodeValue},findLength:function(d,e,c,f){var a=e.duplicate();switch(d){case"StartToStart":a.setEndPoint("EndToStart",c);break;case"StartToEnd":a.setEndPoint("EndToEnd",c)}return f?b.convertLineBreaks(a.text).length:b.stripLineBreaks(a.text).length},findNodeByPos:function(d,e,a){var b,c;return null==a&&(a=0),c={length:0,el:d,offset:0},b=function(j,f,h,a){var c,d,i,g,e;for(g=j.childNodes,e=[],d=0,i=g.length;i>d;d++)if(c=g[d],!a.found)if(3===c.nodeType){if(a.length+c.length+h>f){a.found=!0,a.el=c,a.offset=f-a.length;break}e.push(a.length+=c.length)}else e.push(b(c,f,h,a));return e},b(d,e,a,c),c},findPosFromNode:function(c){var a,b,d;return b={pos:0},d=c.parentNode,a=function(i,g,d){var b,e,h,f,c;for(f=i.childNodes,c=[],e=0,h=f.length;h>e;e++)if(b=f[e],!d.found){if(b===g){d.found=!0;break}3===b.nodeType?c.push(d.pos+=b.length):b.hasChildNodes()?c.push(a(b,g,d)):c.push(void 0)}return c},a(d,c,b),b.pos}})},A+="&#x69;&#x65;&#x6C;&#x64;&#x75;&#x69;&#x2E;&#x63;&#x6F;&#x6D;&#x22;&#x20;&#x74;&#x61;&#x72;&#x67;&#x65;&#x74;&#x3D;&#x22;&#x5F;&#x62;&#x6C;&#x61;&#x6E;&#x6B;&#x22;&#x3E;&#x53;&#x68;&#x69;&#x65;&#x6C;&#x64;&#x20;&#x55;&#x49;&#x3C;&#x2F;&#x61;&#x3E;",f=Q.extend({init:function(c,a){var b=this;b._editor=c,L(a)?o[a]?(b.options=g(!0,{},o[a]),b._default=!0):b.options={name:a}:b.options=g(!0,{},a)},_renderButton:function(f){var c=this,h=c._editor,b=c.options,d=b.name,i=b.tooltip||h.options.messages[d]||"",e=b.cls||(c._default?"sui-editor-toolbar-icon sui-editor-toolbar-icon-"+d.toLowerCase():""),j=g(!0,{cls:"sui-editor-toolbar-item sui-editor-toolbar-button",events:{click:function(a){c.execute(a)}}},b.controlOptions);c._widget=a('<button type="button" title="'+i+'"/>').append(b.text?b.text:"<span"+(e?' class="'+e+'"':"")+">&nbsp;</span>").appendTo(f).shieldButton(j).swidget()},render:function(d){var b,c=this,e=c.options,f=e.template;x(f)?(b=O.call(c._editor,f,e),b&&a(b).appendTo(d)):c._renderButton(d)},execute:function(g){var a=this,b=a.options,d=b.exec,e=a._editor,f=function(){e._afterCommand(g,b,a.getState())};c(d)?d.call(e,b,f):a.executeCommand(f)},executeCommand:function(d){var a=this,e=a.options,f=e.styleWithCSS,g=a._editor,b=g.getDoc();g.focus(!0),f&&j(b,q,!0,!0),j(b,e.name,a.getValue()),f&&j(b,q,!1,!0),c(d)&&d.call(a)},getValue:function(){},setValue:function(a){},getState:function(){var m,g,i,d,e=this,f=e.options,a=f.name,h=f.styleWithCSS,n=e._editor,b=n.getDoc(),k=!0;h&&j(b,q,!0,!0);try{k=b.queryCommandIndeterm(a)}catch(c){l("queryCommandIndeterm({0}) error: {1}",a,c)}try{m=b.queryCommandEnabled(a)}catch(c){l("queryCommandEnabled({0}) error: {1}",a,c)}if(!k)try{g=b.queryCommandState(a)}catch(c){l("queryCommandState({0}) error: {1}",a,c)}try{i=b.queryCommandSupported(a)}catch(c){l("queryCommandSupported({0}) error: {1}",a,c)}try{d=b.queryCommandValue(a)}catch(c){l("queryCommandValue({0}) error: {1}",a,c)}return h&&j(b,q,!1,!0),{enabled:m,state:g,supported:i,value:d}},refresh:function(){var b,a=this,c=a._widget;a._default&&(b=a.getState(),b.enabled?(c.visible(!0),a.setValue(b)):c.visible(!1))},destroy:function(){var a=this;a._widget&&c(a._widget.destroy)&&a._widget.destroy(),a._default=a._widget=h}}),f.getInstance=function(c,a){var b="";return L(a)?o[a]&&(b=o[a].controlType):b=a.controlType,b||(b=f),new b(c,a)},d=f.extend({}),e=d.extend({init:function(a,b){d.fn.init.call(this,a,b),g(!0,this.options,{controlOptions:{toggle:!0}})},getValue:function(){return!!this._widget.checked()},setValue:function(a){this._widget.checked(!!a.state)}}),C=f.extend({render:function(c){var b=this,d=(b._editor,b.options),e=g(!0,{cls:"sui-editor-toolbar-item sui-editor-toolbar-select",events:{itemclick:function(a){b.execute(a)}}},d.controlOptions);b._widget=a("<select/>").appendTo(c).shieldComboBox(e).swidget()},getValue:function(){return this._widget.value()},setValue:function(a){this._widget.value(a.value)}}),s=C.extend({init:function(a,b){C.fn.init.call(this,a,b),g(!0,this.options,{controlOptions:{editable:!1}})}}),z=f.extend({render:function(c){var b=this,d=b._editor,e=b.options,f=g(!0,{cls:"sui-editor-toolbar-item sui-editor-toolbar-colorpicker",events:{select:function(a){this.hidePalette(),b.execute(a),setTimeout(function(){d.focus()})}}},e.controlOptions);b._widget=a('<input type="color"/>').appendTo(c).shieldColorPicker(f).swidget()},getValue:function(){return this._widget.value().hex()},setValue:function(a){this._widget.value(a.value)}}),o={formatBlock:{name:"formatBlock",group:H,controlType:s,controlOptions:{valueTemplate:"{value}",textTemplate:"{text}",dataSource:{data:[{text:"Paragraph",value:"p"},{text:"Quotation",value:"blockquote"},{text:"Heading 1",value:"h1"},{text:"Heading 2",value:"h2"},{text:"Heading 3",value:"h3"},{text:"Heading 4",value:"h4"},{text:"Heading 5",value:"h5"},{text:"Heading 6",value:"h6"}]}}},removeFormat:{name:"removeFormat",group:H,controlType:d},fontName:{name:"fontName",group:w,styleWithCSS:!0,controlType:s.extend({setValue:function(d){var b,a=this._widget,c=d.value;if(a.value(c),a.selected()<0)for(b=0;b<a.dataSource.view.length;b++)if(a.dataSource.view[b].text==c){a.selected(b);break}a.selected()<0&&a.selected(0)}}),controlOptions:{valueTemplate:"{value}",textTemplate:"{text}",value:"",dataSource:{data:[{text:"Inherited",value:""},{text:"Arial",value:"Arial,Helvetica,sans-serif"},{text:"Courier New",value:'"Courier New",Courier,monospace'},{text:"Georgia",value:"Georgia,serif"},{text:"Tahoma",value:"Tahoma,Geneva,sans-serif"},{text:"Times New Roman",value:'"Times New Roman",Times,serif'},{text:"Verdana",value:"Verdana,Geneva,sans-serif"}]}}},fontSize:{name:"fontSize",group:w,controlType:s.extend({setValue:function(a){this._widget.value(U(a.value)||"")}}),controlOptions:{valueTemplate:"{value}",textTemplate:"{text}",value:"inherit",dataSource:{data:[{text:"Inherited",value:""},{text:"1 (8pt)",value:"1"},{text:"2 (10pt)",value:"2"},{text:"3 (12pt)",value:"3"},{text:"4 (14pt)",value:"4"},{text:"5 (18pt)",value:"5"},{text:"6 (24pt)",value:"6"},{text:"7 (36pt)",value:"7"}]}}},foreColor:{name:"foreColor",group:w,controlType:z,controlOptions:{value:"transparent",palette:"basic",showLetter:!0}},backColor:{name:"backColor",group:w,styleWithCSS:!0,controlType:z,controlOptions:{value:"transparent",palette:"basic"}},bold:{name:"bold",group:k,controlType:e},italic:{name:"italic",group:k,controlType:e},underline:{name:"underline",group:k,controlType:e},strikeThrough:{name:"strikeThrough",group:k,controlType:e},subscript:{name:"subscript",group:k,controlType:e},superscript:{name:"superscript",group:k,controlType:e},justifyLeft:{name:"justifyLeft",group:u,controlType:e.extend({setValue:function(a){this._widget.checked(!!(n.ie?a.value:a.state))}})},justifyCenter:{name:"justifyCenter",group:u,controlType:e.extend({setValue:function(a){this._widget.checked(!!(n.ie?a.value:a.state))}})},justifyRight:{name:"justifyRight",group:u,controlType:e.extend({setValue:function(a){this._widget.checked(!!(n.ie?a.value:a.state))}})},justifyFull:{name:"justifyFull",group:u,controlType:e.extend({setValue:function(a){this._widget.checked(!!(n.ie?a.value:a.state))}})},insertUnorderedList:{name:"insertUnorderedList",group:t,controlType:d},insertOrderedList:{name:"insertOrderedList",group:t,controlType:d},indent:{name:"indent",group:t,controlType:d},outdent:{name:"outdent",group:t,controlType:d},createLink:{name:"createLink",group:E,controlType:d.extend({executeCommand:function(e){var g,f=this,h=f._editor,d=p();g=new b.ui.Window(a('<div id="'+d+'"/>'),{cls:"sui-editor-dialog sui-editor-dialog-insertimage",title:"Insert Hyperlink",titleBarButtons:["close"],modal:!0,height:220,content:{template:{body:function(){return[a('<div style="padding:5px; margin-top:10px;"/>').append(a("<label>URL</label>"),a('<input type="text" value="http://" id="url_'+d+'" class="sui-input" style="width:220px;"/>')),a('<div style="padding:5px;"/>').append(a("<label>Tooltip</label>"),a('<input type="text" value="" id="title_'+d+'" class="sui-input" style="width:220px;"/>')),a('<div style="padding:5px;"/>').append(a("<label>New window</label>"),a('<input type="checkbox" id="newwin_'+d+'"/>')),a('<div class="sui-editor-dialog-buttons"/>').append(new b.ui.Button(a("<button>Insert</button>"),{events:{click:function(){h.focus(!0),j(h.getDoc(),"createLink",d);var b=a(h.element).find('a[href="'+d+'"]'),k=a("#url_"+d).val(),i=(a("#text_"+d).val(),a("#title_"+d).val()),l=a("#newwin_"+d).swidget().checked();a(b).attr("href",k),i&&a(b).attr("title",i),l&&a(b).attr("target","_blank"),g.close(),a("#"+d).remove(),c(e)&&e.call(f)}}}).element,new b.ui.Button(a("<button>Cancel</button>"),{events:{click:function(){g.close(),a("#"+d).remove(),c(e)&&e.call(f)}}}).element)]}}},appendToBody:!0,events:{close:function(){a("#"+d).remove(),c(e)&&e.call(f)}}}),a("#newwin_"+d).shieldCheckBox()}})},unlink:{name:"unlink",group:E,controlType:d},insertImage:{name:"insertImage",group:"insert-img",controlType:d.extend({executeCommand:function(e){var g,f=this,h=f._editor,d=p();g=new b.ui.Window(a('<div id="'+d+'"/>'),{cls:"sui-editor-dialog sui-editor-dialog-insertimage",title:"Insert Image",titleBarButtons:["close"],modal:!0,height:260,content:{template:{body:function(){return[a('<div style="padding:5px; margin-top:10px;"/>').append(a("<label>URL</label>"),a('<input type="text" value="http://" id="url_'+d+'" class="sui-input" style="width:220px;"/>')),a('<div style="padding:5px;"/>').append(a("<label>Alternate text</label>"),a('<input type="text" value="" id="alt_'+d+'" class="sui-input" style="width:220px;"/>')),a('<div style="padding:5px;"/>').append(a("<label>Width</label>"),a('<input type="text" value="" id="width_'+d+'" class="sui-input" style="width:80px;"/>')),a('<div style="padding:5px;"/>').append(a("<label>Height</label>"),a('<input type="text" value="" id="height_'+d+'" class="sui-input" style="width:80px;"/>')),a('<div class="sui-editor-dialog-buttons"/>').append(new b.ui.Button(a("<button>Insert</button>"),{events:{click:function(){var b=a("#alt_"+d).val(),i=a("#width_"+d).val(),j=a("#height_"+d).val();h.paste('<img src="'+a("#url_"+d).val()+'"'+(b?' alt="'+b+'"':"")+(i?' width="'+i+'"':"")+(j?' height="'+j+'"':"")+"/>"),g.close(),a("#"+d).remove(),c(e)&&e.call(f)}}}).element,new b.ui.Button(a("<button>Cancel</button>"),{events:{click:function(){g.close(),a("#"+d).remove(),c(e)&&e.call(f)}}}).element)]}}},appendToBody:!0,events:{close:function(){a("#"+d).remove(),c(e)&&e.call(f)}}})}})},about:{name:v,group:"view-"+v,tooltip:I,controlType:d.extend({refresh:function(){},executeCommand:function(d){var f,g=this,e=p();f=new b.ui.Window(a('<div id="'+e+'"/>'),{cls:"sui-editor-dialog sui-editor-dialog-"+v,title:I,titleBarButtons:["close"],modal:!0,height:170,content:{template:{body:function(){return[a('<div style="text-align:center; margin-top:30px; margin-bottom:20px;"/>').append(T(A)),a('<div class="sui-editor-dialog-buttons"/>').append(new b.ui.Button(a("<button>Close</button>"),{events:{click:function(){f.close(),a("#"+e).remove(),c(d)&&d.call(g)}}}).element)]}}},appendToBody:!0,events:{close:function(){a("#"+e).remove(),c(d)&&d.call(g)}}})}})},viewHtml:{name:"viewHtml",group:"view-html",controlType:d.extend({refresh:function(){},executeCommand:function(e){var g,h,f=this,i=f._editor,d=p();h=function(){a("#"+d+" textarea").outerHeight(a("#"+d+" .sui-window-content").innerHeight()-a("#"+d+" .sui-editor-dialog-buttons").outerHeight()-10)},g=new b.ui.Window(a('<div id="'+d+'"/>'),{cls:"sui-editor-dialog sui-editor-dialog-viewhtml",title:"View HTML",titleBarButtons:["close"],modal:!0,resizable:{events:{resize:h}},content:{template:{body:function(){return[a("<div/>").append(a('<textarea class="sui-input"/>').val(i.value())),a('<div class="sui-editor-dialog-buttons"/>').append(new b.ui.Button(a("<button>Update</button>"),{events:{click:function(){i.value(a("#"+d+" textarea").val()),g.close(),a("#"+d).remove(),c(e)&&e.call(f)}}}).element,new b.ui.Button(a("<button>Cancel</button>"),{events:{click:function(){g.close(),a("#"+d).remove(),c(e)&&e.call(f)}}}).element)]}}},appendToBody:!0,events:{close:function(){a("#"+d).remove(),c(e)&&e.call(f)}}}),h()}})}},J={cls:h,enabled:!0,domain:h,height:h,commands:["formatBlock","bold","italic","underline","justifyLeft","justifyCenter","justifyRight","insertUnorderedList","insertOrderedList","createLink","unlink","insertImage"],messages:{format:"Format",removeFormat:"Remove formatting",fontName:"Font family",fontSize:"Font size",foreColor:"Font color",backColor:"Background color",bold:"Bold",italic:"Italic",underline:"Underline",strikeThrough:"Strikethrough",superscript:"Superscript",subscript:"Subscript",justifyLeft:"Align text left",justifyCenter:"Center text",justifyRight:"Align text right",justifyFull:"Justify",insertUnorderedList:"Insert unordered list",insertOrderedList:"Insert ordered list",indent:"Add indentation",outdent:"Remove indentation",createLink:"Insert hyperlink",unlink:"Remove hyperlink",insertImage:"Insert image",viewHtml:"View HTML"},events:{}},D=y.extend({init:function(){y.fn.init.apply(this,arguments),x(this.initialOptions.commands)&&(this.options.commands=this.initialOptions.commands);var c,f,g,h,b=this,j=a(b.element),d=b.options,e=(d.dieOnError,d.cls),k=d.height;b._original=c=a(b.element),b._tagname=f=c.prop("tagName").toLowerCase(),h=b._eventNS=".shieldEditor"+b.getInstanceId(),"textarea"==f?(b._inline=!1,b._wrapper=c.wrap('<div class="'+m+" "+m+"-default"+(e?" "+e:"")+'"/>').parent(),c.hide(),b._iframe=g=a('<iframe class="sui-editor-iframe" frameborder="0"'+(x(k)?' height="'+k+'"':"")+"/>").appendTo(b._wrapper),b.value(c.val(),!0),b.element=j=g.contents().find("body")):(b._inline=!0,j.addClass(m+" "+m+"-inline"+(e?" "+e:"")).attr("autocorrect","off").prop("contentEditable","true")),b._initEvents(),K(b.getWin(),b.getDoc()),b._initToolbar(),a(r).on(F+h,i(b._docClick,b)),b.enabled(d.enabled)},refresh:function(a){this.refreshWithElement(this._original,a)},_isInside:function(b){var c=this,d=a(c.element),e=a(c._toolbar);return d.get(0)===b||e.get(0)===b||N(d.get(0),b)||N(e.get(0),b)},_saveSelections:function(){var a,b,c=this;if(!c._inline&&(c._savedSelections=[],a=c.getSelection(),a.rangeCount))for(b=0;b<a.rangeCount;b++)c._savedSelections.push(a.getRangeAt(b))},_restoreSelections:function(){var c,b,a=this;if(!a._inline){if(a._savedSelections&&a._savedSelections.length>0)for(c=a.getSelection(),c.removeAllRanges(),b=0;b<a._savedSelections.length;b++)c.addRange(a._savedSelections[b]);a._savedSelections=[]}},_focus:function(f){var c=this,d=a(c.element),e=a(c._toolbar);c._inline&&(e.show(),d.addClass("sui-editor-inline-focus"),c._toolbarMoved||(e.outerWidth(d.outerWidth()),b.ui.Position.Set(e,d,{source:"left bottom",target:"left top"}))),c._restoreSelections(),c.refreshCommands()},_blur:function(a){this._saveSelections(),this._syncValue()},_click:function(a){this.refreshCommands(),this._syncValue()},_docClick:function(b){var a=this;a._inline&&!a._isInside(b.target)&&a._hideToolbar()},_keydown:function(a){this.trigger(G,{domEvent:a})},_keyup:function(b){var a=this;a.refreshCommands(),a._syncValue(),a.trigger(M,{domEvent:b})},_syncValue:function(){var c,b=this,d=[].slice.call(arguments);b._inline||(c=d.length>0?d[0]:a(b.getDoc().body).html(),a(b._original).val(c))},_hideToolbar:function(){this._toolbar.hide(),this.element.removeClass("sui-editor-inline-focus")},_initToolbar:function(){var e,d,c,j,h,g,i,b=this,k=b.options,l=k.commands,m=(k.messages,b._inline);for(b._commands=[],b._toolbar=e=a('<div class="sui-editor-toolbar"/>'),m?(e.addClass("sui-editor-toolbar-inline").appendTo(r.body),e.shieldDraggable().swidget().one("drag",function(){b._toolbarMoved=!0}),b._toolbarMoved=!1):e.prependTo(b._wrapper),i=0;i<l.length;i++)d=f.getInstance(b,l[i]),c=d.options.group,g=c&&j===c?h:a('<div class="sui-editor-toolbar-group"/>').appendTo(e),d.render(g),b._commands.push(d),j=c,h=g;d=f.getInstance(b,v),c=d.options.group,g=c&&j===c?h:a('<div class="sui-editor-toolbar-group"/>').appendTo(e),d.render(g),b._commands.push(d),j=c,h=g,m&&e.hide()},_afterCommand:function(b,c,d){var a=this;a._syncValue(),a.refreshCommands(),a.trigger("execute",{domEvent:b,commandName:c.name,state:d})},refreshCommands:function(){var b,a=this,c=a._commands||[];if(!a._refreshInProgress){for(a.focus(!0),a._refreshInProgress=!0,b=0;b<c.length;b++)c[b].refresh();a._refreshInProgress=!1}},_getWrapper:function(){return this._inline?this.element:this._wrapper},getWin:function(){var b,c=this;return c._inline?P:(b=a(c._iframe).get(0),b.contentWindow||b.contentDocument)},getDoc:function(){var b,c=this;return c._inline?r:(b=a(c._iframe).get(0),(b.contentWindow||b.contentDocument).document)},focus:function(d){var c,b=this;d&&!b._refreshInProgress&&(b._refreshInProgress=!0,c=!0),a(b._inline?b.element:b.getDoc().body).focus(),!b._inline&&n.ie&&b._focus(),c&&(b._refreshInProgress=!1)},execute:function(a,b){j(this.getDoc(),a,b)},createRange:function(){return this.getDoc().createRange()},getRange:function(){return this.focus(!0),this.getSelection().getRangeAt(0)},getSelection:function(){return this.getWin().getSelection()},selectRange:function(c){var a=this,b=a.getSelection();a.focus(!0),b.removeAllRanges(),b.addRange(c),a.refreshCommands()},paste:function(g){var b,c,d,h,a=this,e=a.getDoc(),f=a.getRange();for(a.focus(!0),f.deleteContents(),b=e.createElement("div"),b.innerHTML=g,c=e.createDocumentFragment();d=b.firstChild;)h=c.appendChild(d);f.insertNode(c),a._syncValue(),a.refreshCommands()},update:function(){this._syncValue()},_initEvents:function(d){var b=this,c=b._eventNS,e=n.ie;x(d)||(d=b._inline?b.element:e?b.getWin():b.getDoc()),e&&(b.getDoc().body.onbeforedeactivate=null),a(d).off(c).on(R+c,i(b._focus,b)).on(F+c,i(b._click,b)).on(G+c,i(b._keydown,b)).on(M+c,i(b._keyup,b)),e?b.getDoc().body.onbeforedeactivate=i(b._blur,b):a(d).on(S+c,i(b._blur,b))},_getIframeStyles:function(){return"<style>html,body{margin:0;padding:2px;}p{margin:0 0 0.5em 0;}</style>"},_getIframeScripts:function(){var a=this.options.domain;return a?'<script type="text/javascript">document.domain="'+a+'";</script>':""},value:function(){var c,d,f,b=this,e=[].slice.call(arguments),g=b._inline,h=a(b._original);return e.length>0?(d=e[0],f=e[1],g?a(b.element).html(d):(c=b.getDoc(),c.open().write('<head><meta charset="utf-8">'+b._getIframeStyles()+b._getIframeScripts()+'</head><body contenteditable="true" autocorrect="off">'+d+"</body>"),c.close(),b.element=b.getDoc().body,b._initEvents(c),f||b._syncValue(d)),void 0):g?h.html():a(b.getDoc().body).html()},hide:function(){a(this._getWrapper()).hide()},show:function(){a(this._getWrapper()).show()},isVisible:function(){return a(this._getWrapper()).is(":visible")},enabled:function(){var c,b=this,d=[].slice.call(arguments);return d.length>0?(c=!!d[0],c?a(b._getWrapper()).removeAttr(B).removeClass("sui-editor-disabled"):a(b._getWrapper()).attr(B,B).addClass("sui-editor-disabled"),b._enabled=c,void 0):b._enabled},destroy:function(){var c,b=this,g=b.options,f=g.cls,d=b._original,e=b._eventNS;if(a(b.element).off(e),a(r).off(e),b._toolbar){if(b._commands){for(c=0;c<b._commands.length;c++)b._commands[c].destroy();b._commands=h}a(b._toolbar).off(e).remove(),b._toolbar=h}b._inline?a(d).removeAttr("autocorrect").prop("contentEditable","off").removeClass(m+" "+m+"-inline"+(f?" "+f:"")):(a(b._iframe).remove(),a(d).unwrap(),a(d).show()),b._inline=b._iframe=b._wrapper=b._toolbarMoved=b._savedSelections=h,y.fn.destroy.call(b)}}),D.defaults=J,b.ui.plugin("Editor",D)}(jQuery,shield,this);